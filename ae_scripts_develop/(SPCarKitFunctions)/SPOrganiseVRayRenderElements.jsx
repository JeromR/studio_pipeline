// SPOrganiseVRayRenderElements ()// Select a folder after using ProEXR plugin and this will organise the preComps into folders{	function StringHasIndexFromArray ( s, a ){		var result = false;		for (var i=0, len=a.length; i<len; i++){			if  (s.indexOf(a[i]) != -1){				result = true;			}		}		return result;	}	function SPOrganiseVRayRenderElementsInFolder ( selectedItem)	{		var items = selectedItem.items;		var matteFolder = items.addFolder ( "Mattes" );		var techFolder = items.addFolder ( "Tech Passes" );		var colourFolder = items.addFolder ( "Colour Passes" );		var lightPasses = items.addFolder ( "Light Select Passes" );				var itemsNotFolders = [];		for (var i=1, len=items.length; i<len; i++)		{			var item = items[i];			if ( !( item instanceof FolderItem ))			{				itemsNotFolders.push (item);			}		}				for (var i=0, len=itemsNotFolders.length; i<len; i++)		{			var item = itemsNotFolders[i];			if  (item.name.indexOf("multimatte") != -1){				item.parentFolder = matteFolder;			}			if  (item.name.indexOf("lightselect") != -1){				item.parentFolder = lightPasses;			}			if (StringHasIndexFromArray ( item.name , ["diffuse","GI","lighting","reflect","refract","RGB","selfIllum","specular"] )){				item.parentFolder = colourFolder;			}			if (StringHasIndexFromArray ( item.name, ["zDepth","AO","Normals","XYZ","UV"] )){				item.parentFolder = techFolder;			}		}		return [matteFolder,techFolder,colourFolder,lightPasses];	}	function SPOrganiseVRayRenderElements ()	{		var scriptName = "Organise Vray Render Elements";				var selectedItems = app.project.selection;			var selectedItem = selectedItems[0];				if ((selectedItems.length > 1) || !(selectedItem instanceof FolderItem)){			alert ("Select one folder containing Vray Render Elements and run the script", scriptName);			return;		}		app.beginUndoGroup(scriptName);		SPOrganiseVRayRenderElementsInFolder ( selectedItem);			app.endUndoGroup();	}		SPOrganiseVRayRenderElements ()}