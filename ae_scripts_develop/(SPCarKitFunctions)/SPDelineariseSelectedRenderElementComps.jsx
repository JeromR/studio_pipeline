// SPDelineariseSelectedRenderElementComps// ProEXR plugin reads passes incorrectly when project is not linear - this delinearises back to working colour profile.{	function StringHasIndexFromArray ( s, a ){		for (var i=0, len=a.length; i<len; i++){			if  (s.indexOf(a[i]) != -1){				return true;			}		}		return false;	}	function LayerHasEffect ( layer , effectMatchName ) {		var effects = layer.Effects;				for (var i=1, len=effects.numProperties; i<=len; i++)		{			var effect = effects.property(i);			if ( effect.matchName == effectMatchName){				return true;			}			}		return false;	}	function SPDelineariseFirstLayerInItems( selectedItems)	{		var i=0;		var len=selectedItems.length;		try { selectedItems[0]; }		catch(err) { i=1; len++;}				for ( i ; i<len; i++)		{			var selectedItem = selectedItems[i];			if (selectedItem instanceof CompItem)			{				if ( !StringHasIndexFromArray ( selectedItem.name, ["RGB","RGBA"]))				{					var layer = selectedItem.layer(1);					if ( !LayerHasEffect ( layer, "ADBE ProfileToProfile")){						var effect = layer.Effects.addProperty("ADBE ProfileToProfile");						effect.property("Linearize Input Profile").setValue(1);					}				}			}		}	}	function SPDelineariseSelectedRenderElementComps()	{		var scriptName = "Deliniarise Selected Render Element PreComps";		app.beginUndoGroup(scriptName);				var selectedItems = app.project.selection;			SPDelineariseFirstLayerInItems( selectedItems);			app.endUndoGroup();	}	SPDelineariseSelectedRenderElementComps()}