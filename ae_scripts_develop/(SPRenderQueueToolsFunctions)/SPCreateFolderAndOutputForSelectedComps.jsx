/*SPCreateFolderAndOutputForSelectedComps()Make a series of folders based ons elected comp names in a given locationWritten by Dnaiel Harkness, Spinifex Group, 2013TODO:detect if new file is a movie and remove the "_[#####]"*/{	function SPCreateFolderAndOutputForSelectedComps()	{		var scriptName = "Create Folder for Render Queue Sequences";				// Check a project is open		if (!app.project)		{			alert ("A project must be open to use this script.", scriptName);			return;		}				var newLocation = Folder.selectDialog("Select a render output folder...");				if (newLocation != null) {			app.beginUndoGroup(scriptName);			var selectedItems = app.project.selection;			/*			//build Intern=face			var myWin = new Window ("dialog", "Settings", undefined)			var addOutputModuleCheckBox = myWin.add("checkbox",undefined,"Add Output Module");			var OMTemplateDropDown = myWin.add("dropdownList",undefined, OMTemplates);			whichOMTemplate.selection = 1;			myWin.add("button",undefined,"OK");			myWin.center();			myWin.show();			*/								for (var i=0,len=selectedItems.length; i<len; i++)			{				var item = selectedItems[i];				if ( selectedItems[i] instanceof CompItem ){					RQItem = app.project.renderQueue.items.add(item);					var lastOMItem = RQItem.outputModules[1];														var sequenceFolderPath = new Folder ( newLocation.toString() + "/" + item.name )					sequenceFolderPath.create();					var sequencePath = new File ( newLocation.toString() + "/" + sequenceFolderPath.name + "/" + item.name + "_[#####]" );										lastOMItem.file = sequencePath;				}			}			app.endUndoGroup();		}	}	SPCreateFolderAndOutputForSelectedComps();}